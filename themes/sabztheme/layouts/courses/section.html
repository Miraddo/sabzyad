{{ define "main" }}

    {{/* Render the courses list for this section; nested course sections will use type-based template at layouts/course/section.html */}}
    {{/* BEGIN: list view (copied from courses/list.html) */}}
    <div class="course-list-page">
        <section class="page-header">
            <div class="container">
                <div class="header-content">
                    <h1>{{ i18n "courses.header_title" }}</h1>
                    <p>{{ i18n "courses.header_subtitle" }}</p>
                    {{ $section := .CurrentSection | default . }}
                    {{ $pages := $section.RegularPages }}
                    {{ $children := $section.Sections }}
                    {{ $sectionLinks := slice }}
                    {{ range $children }}
                        {{ $sectionLinks = $sectionLinks | append .RelPermalink }}
                    {{ end }}
                    {{ $pagesFiltered := slice }}
                    {{ range $pages }}
                        {{ if not (in $sectionLinks .RelPermalink) }}
                            {{ $pagesFiltered = $pagesFiltered | append . }}
                        {{ end }}
                    {{ end }}
                    {{ $allCourses := union $pagesFiltered $children }}
                    <div class="header-stats">
                        <div class="stat-card"><div class="stat-icon">üìö</div><div class="stat-info"><div class="stat-number">{{ len $allCourses }}</div><div class="stat-label">{{ i18n "courses.stats.available" }}</div></div></div>
                        <div class="stat-card"><div class="stat-icon">üÜì</div><div class="stat-info"><div class="stat-number">100%</div><div class="stat-label">{{ i18n "courses.stats.free" }}</div></div></div>
                        <div class="stat-card"><div class="stat-icon">‚è∞</div><div class="stat-info"><div class="stat-number">24/7</div><div class="stat-label">{{ i18n "courses.stats.access" }}</div></div></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="course-filters-section">
            <div class="container">
                <div class="filters-container">
                    <div class="filter-group">
                        <label>{{ i18n "courses.filter.category" }}</label>
                        <div class="filter-options">
                            <a href="#" class="filter-btn active" data-filter="all">{{ i18n "courses.filter.all" }}</a>
                            {{ range .Site.Taxonomies.course_categories }}
                                <a href="#" class="filter-btn" data-filter="{{ .Page.Title }}">{{ .Page.Title }}</a>
                            {{ end }}
                        </div>
                    </div>
                    <div class="filter-group">
                        <label>{{ i18n "courses.filter.level" }}</label>
                        <div class="filter-options">
                            <a href="#" class="filter-btn" data-level="all">{{ i18n "courses.filter.level_all" }}</a>
                            <a href="#" class="filter-btn" data-level="{{ i18n "courses.level.beginner" }}">{{ i18n "courses.level.beginner" }}</a>
                            <a href="#" class="filter-btn" data-level="{{ i18n "courses.level.intermediate" }}">{{ i18n "courses.level.intermediate" }}</a>
                            <a href="#" class="filter-btn" data-level="{{ i18n "courses.level.advanced" }}">{{ i18n "courses.level.advanced" }}</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="courses-content">
            <div class="container">
                <div class="courses-grid">
                    {{ range $allCourses }}
                        {{ $isLesson := or (eq .Type "lessons") (eq (lower .Section) "lessons") (eq .Params.type "lessons") }}
                        {{ if not $isLesson }}
                        <div class="course-card" data-category="{{ range .Params.course_categories }}{{ . }} {{ end }}" data-level="{{ .Params.difficulty }}">
                            <div class="course-image">
                                {{ if .Params.image }}
                                    <img src="{{ .Params.image }}" alt="{{ .Title }}" loading="lazy">
                                {{ else }}
                                    <div class="image-placeholder"><div class="placeholder-icon">üìö</div></div>
                                {{ end }}
                                {{ if .Params.difficulty }}<div class="course-level">{{ .Params.difficulty }}</div>{{ end }}
                                {{ if .Params.duration }}
                                    <div class="course-duration"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12,6 12,12 16,14"></polyline></svg>{{ .Params.duration }}</div>
                                {{ end }}
                            </div>
                            <div class="course-content">
                                <h3 class="course-title"><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
                                {{ if .Params.description }}
                                    <p class="course-description">{{ .Params.description }}</p>
                                {{ else }}
                                    <p class="course-description">{{ .Summary | truncate 120 }}</p>
                                {{ end }}
                            </div>
                            <div class="course-footer">
                                <a href="{{ .Permalink }}" class="course-btn"><span class="btn-text">{{ i18n "header.start_learning" }}</span><svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg></a>
                            </div>
                        </div>
                        {{ end }}
                    {{ end }}
                </div>
                {{ if eq (len $allCourses) 0 }}
                <div class="no-courses"><div class="no-courses-icon">üìö</div><h3>{{ i18n "courses.no_courses.title" }}</h3><p>{{ i18n "courses.no_courses.subtitle" }}</p></div>
                {{ end }}
            </div>
        </section>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded',function(){const e=document.querySelectorAll('.filter-btn'),t=document.querySelectorAll('.course-card');function a(){const a=document.querySelector('[data-filter].active')?.dataset.filter||'all',r=document.querySelector('[data-level].active')?.dataset.level||'all';t.forEach(e=>{const t=e.dataset.category,n=e.dataset.level,i=('all'===a||t.includes(a))&&('all'===r||n===r);e.style.display=i?'block':'none'})}
    e.forEach(t=>{t.addEventListener('click',function(t){t.preventDefault();const n=this.closest('.filter-group');n.querySelectorAll('.filter-btn').forEach(e=>e.classList.remove('active')),this.classList.add('active'),a()})});});
    </script>
    {{/* END: list view */}}

{{ end }}
