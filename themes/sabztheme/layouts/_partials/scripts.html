<script>
  // Mobile menu functionality
  document.addEventListener('DOMContentLoaded', function() {
    const burger = document.querySelector('.navbar-burger');
    const menu = document.querySelector('.navbar-menu');

    if (burger && menu) {
      burger.addEventListener('click', function() {
        burger.classList.toggle('is-active');
        menu.classList.toggle('is-active');
      });
    }

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Back to top button
    const backToTop = document.createElement('button');
    backToTop.innerHTML = '↑';
    backToTop.className = 'back-to-top';
    backToTop.setAttribute('aria-label', 'بازگشت به بالا');
    document.body.appendChild(backToTop);

    backToTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    window.addEventListener('scroll', () => {
      if (window.pageYOffset > 100) {
        backToTop.classList.add('show');
      } else {
        backToTop.classList.remove('show');
      }
    });
  });

  // Progress tracking for course pages
  function trackCourseProgress() {
    const lessonItems = document.querySelectorAll('.lesson-item');
    const progressBar = document.querySelector('.course-progress');
    
    if (lessonItems.length > 0 && progressBar) {
      let completedLessons = 0;
      
      lessonItems.forEach(item => {
        if (item.classList.contains('completed')) {
          completedLessons++;
        }
      });
      
      const progressPercentage = (completedLessons / lessonItems.length) * 100;
      progressBar.style.width = progressPercentage + '%';
      progressBar.setAttribute('aria-valuenow', progressPercentage);
    }
  }

  // Call progress tracking on page load
  document.addEventListener('DOMContentLoaded', trackCourseProgress);
</script>

<style>
  .back-to-top {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 3rem;
    height: 3rem;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.2rem;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1000;
  }

  .back-to-top.show {
    opacity: 1;
    visibility: visible;
  }

  .back-to-top:hover {
    background: var(--secondary-color);
    transform: translateY(-3px);
  }

  /* RTL adjustments for back to top button */
  .rtl .back-to-top {
    right: auto;
    left: 2rem;
  }
</style>
